# Anthem

Esta máquina de Try Hack Me, nos guía en todo momento, así que vamos a ir haciendola poco a poco.

# Análisis

> Por lo que se ve en el THM, la máquina es bastante sencilla, me limitaré a seguir las preguntas pero desarrollando.

Empezamos el análisis con un escaneo de puertos simple:

![alt text](img/image.png)

Vemos un servicio web en el puerto 80, y un escritorio remoto en el 3389.

Si entramos en el servicio web, apreciamos una especie de bolg personal:

![alt text](img/image-1.png)

Metiendome en enlaces del propio bolg, he sacado esta flag:

![alt text](img/image-2.png)
> THM{L0L_WH0_D15}

![alt text](img/image-3.png)
> Un poema(?)
> Parece que es muy conocido en CTFs

![alt text](img/image-4.png)
> THM{G!T_G00D}

Y poco más, voy a hacer un fuzzeo a ver que sale:

![alt text](img/image-5.png)
> Me he cargado gobuster(?)

Mis herramientas de fuzzeo parece que no funcionan, pruebo con los direcorios típicos y sale esto:

![alt text](img/image-6.png)
> Lo que parece una contraseña
> El CMS *umbraco*

![alt text](img/image-7.png)

Esto nos redirige a un login, tenemos la contraseña, falta el usuario:

![alt text](img/image-8.png)

No es ni este, ni otro que he deducido usando la misma lógica: jh@anthem.com

La única pista que tengo es el poema de antes, chatGPT dice que se trata de un poema de *Solomon Grundy*.(sg@anthem.com)(?)

![alt text](img/image-9.png)
> Un poco rebuscado la verdad...

---

Segunda sección del try hack me, donde tendremos que encontrar las flags(entiendo que las que se encuentran en la web)

Ya encontre 2 antes, las pongo aquí:

![alt text](img/image-2.png)
> flag 3
> THM{L0L_WH0_D15}

![alt text](img/image-4.png)
> flag 2
> THM{G!T_G00D}

Para el resto, parece que vamos a tener que seguir buscando.

![alt text](img/image-10.png)
> flag 1
> THM{L0L_WH0_US3S_M3T4}

![alt text](img/image-11.png)
> flag 4
> THM{AN0TH3R_M3TA}

Literalmente, todas las flags se pueden encontrar desde un principio, solo hay que inspeccionar el código fuente de la página.

---

Tercera y última sección, aquí tendremos que entrar en la máquina y escalar privilegios.

En el análisis de puertos, vimos que el servidor tiene un escritorio remoto, vamos a intentar iniciar sesión con las credenciales que tenemos:

![alt text](img/image-13.png)
> Claro, así da error, un usuario de windows no puede tener un dominio de correos, poner solo sg en el campo usuario.

![alt text](img/image-12.png)

Ya hemos iniciado sesión con un usuario normal en la máquina, y en el escritorio tenemos la primera flag:

![alt text](img/image-14.png)

THM nos da una pista para encontrar la contraseña del administrado: *It is hidden*, pruebo a mostrar los archivos ocultos desde el explorador:

![alt text](img/image-15.png)
![alt text](img/image-16.png)

Encontramos un archivo en una carpeta oculta, pero no podemos abrirlo por temas de permisos.

![alt text](img/image-17.png)

Nadie tiene permisos para ver/editar el archivo(OK), lo editamos y añadimos a SG:

![alt text](img/image-18.png)
![alt text](img/image-19.png)
> Contraseña del root

Ahora podriamos cerrar sesión SG e iniciar con Administrator:

![alt text](img/image-20.png)
> ChangeMeBaby1MoreTime

Y ya estaría, una forma extraña de escalar privilegios.

