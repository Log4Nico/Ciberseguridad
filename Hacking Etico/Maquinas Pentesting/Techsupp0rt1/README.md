# Techsupp0rt1

Máquina "fácil" de windows en la que solo nos pide la flag del root.

# Análisis

Empezamos el análisis con un escaneo de puertos:

![alt text](img/image.png)

Encontramos un servidor http en el puerto 80, ssh en el 22, y smb en el 139 y 445.

Vamos a investigar primeramente los smb, que creo que tardaremos menos:

![alt text](img/image-1.png)

Encontramos un archivo *enter.txt*

![alt text](img/image-2.png)

Parece que en el servidor hay un wordpress con las credenciales de abajo, y un directorio */subrion* que no funciona.

Podemos empezar a hacer fuzzeos en 2 sitios, en la raíz */* y en */subrion*:

![alt text](img/image-3.png)

En la raíz encotramos un */test* y un */wordpress*

En test, **parece** que no hay nada.

En subrion, encontramos un **robots.txt**:
![alt text](img/image-4.png)
![alt text](img/image-5.png)
> A destacar, vemos un */panel*

![alt text](img/image-6.png)
> Aún no tenemos credenciales de subrion.

En */wordpress*, encontramos el **wp-login**

![alt text](img/image-7.png)

Podemos usar ciberchef para intentar descifrar la contraseña que vimos antes:

![alt text](img/image-8.png)
> Estaba cifrada varias veces

![alt text](img/image-9.png)
![alt text](img/image-10.png)
> ¬¬

![alt text](img/image-11.png)
![alt text](img/image-12.png)
> Pero si ponía que era del wordpress...

En este panel, podemos ver que el CMS es Subrion 4.2.1

![alt text](img/image-13.png)

![alt text](img/image-14.png)

La que más sentido tiene, es la de subir archivos arbitrarios, para crear una shell reversa.

![alt text](img/image-15.png)

Aunque parezca que ya habríamos acabado, aún queda por hacer, desde esta *shell* poco podemos hacer más que mirar archivos. Vamos a buscar archivos de configuración de wordpress, muchas veces dejan la contraseña en texto plano:

![alt text](img/image-16.png)
> Correcto

También encontramos el siguiente usuario en la máquina:

![alt text](img/image-17.png)

Un usuario que se llama *scam* y una contraseña que tiene *iamscamer*, probemos el SSH:

![alt text](img/image-18.png)

Perfecto, solo nos queda escalar privilegios, esta room no tiene flag de user.

Vemos los permisos con sudo -l:

![alt text](img/image-19.png)

Según gtfobins:

![alt text](img/image-20.png)

Normalmente, estos restos siempre tienen la flag en el directorio */home/user/desktop/user.txt* o */root/root.txt*:

![alt text](img/image-21.png)

Y ya estaría resuelta la room.